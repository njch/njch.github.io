<!DOCTYPE html>
<html><head>
  <style type="text/css">
      .NZ { display:none; };
      @font-face {
          font-family: DVSM;
          src: url('DejaVuSansMono.ttf');
      }
      @font-face {
          font-family: XMAS;
          src: url('MountainsofChristmas.ttf');
      }
      body::-webkit-scrollbar {
          width: 0em;
          height: 0em;
      }
      input[type=range] {
          -webkit-appearance: none;
          background: black;
          height: 0px;;
      }
      input[type=range]::-webkit-slider-thumb {
          -webkit-appearance: none;
          background: url(copper_anodes.jpg);
          height: 2em;
          width: 2em;
          border-radius: 1em;
          cursor: crosshair;
          box-shadow: 1px 1px 1px #000000, 0px 0px 1px #0d0d0d;
      }
      body {
          font-family: DVSM, mono;
      }
      ww * { pointer-events:none; }
      ww * * { pointer-events:all; }
      
  </style>

  <script src="paper.js"></script>
  <script src="paper.animate.js"></script>
<script src="jquery.min.js" type="text/javascript"></script>

  <script canvas="display" type="text/paperscript">
      var uplg = new PaperAnimate.Updater();
    
      var shape = new Path.RegularPolygon(view.center, 3, 100);
      shape.fillColor = '#333bbb';
      shape//.animate(5, uplg, true)
           //.translate(new Point(200,100))
           .rotate(60)
           .scale(2);

      var text = new PointText(view.center);
      text.justification = 'center';
      text.fillColor = 'green';
      text.content = 'STYLEHOUSE';
      text.scale(14);
       text.animate(11, uplg).scale(33);

      var shape = new Path.RegularPolygon(view.center,3, 100);

   function onFrame(e) {
        a.uplg = uplg;
        a.proj = project;
        if (a.stut)
            return;
        
        uplg.update(e);
        
        if (a.frame)
            a.frame(e);
        
        if (a.yl) {
          a.stut = 1;
          if (!a.stul)
              a.stul = 90;
          a.yl(a.stul,function(){ 
              delete(a.stut);
          });
        }
   }
   
   
  </script>


</head><body style="margin: 0px; background: black; color: #0d2; height:100%; width:100%;">
    <div id='nomsgs' style="white-space: pre;position:absolute;font-size:60%;left:0em;bottom:0em;width:50%;height:28%; overflow:hidden;padding:0.2em;color:#abc;z-index:200" onclick="keon();clon();a.togwid('#msgs','50%','5%');" > </div>
    <div id='ux' style="position:absolute;top:0em;
    right:0em;width:100%;height:100%;"> </div>

    <canvas id="display" resize></canvas>

    <script type="text/javascript">
      // default, top level #c
      var w = {conin: 'ws://'+location.host+'/s'};
      var fail = 0;
      var a = {};
      a.N = {}
      var q = 1;
      var elvis = Math.random();
      var ws;
      var etc = {};
      var C = {};
      var conz = {};
      var mm = {};
      var ww = {};
      
      a.togwid = function(m,fr,to) {
          if ($(m).attr('togwid') == to)
              to = fr
          $(m).attr('togwid', to)
          $(m).css('width', to);
      };
      
      // splate

      a.e = function(e) { eval(e); };
      a.m = function(e) {
          var d = e.substr(0,1);
          if (d == " ") {
            a.e(e);
          }
          else {
            if (d == ".") {
              e = '<span style="font-size:66%">'+e+'</span>';
            }
            a.c(e);
          }
      };
      a.c = function(e) {
          $('#msgs').prepend(e+"\n");
      };


      // click, keys
      function clon () {0 && $(window).on("click", a.cl); }
      function clof () { $(window).off("click", a.cl); }
      function keon () {0 && $(window).on("keydown", a.ke); }
      function keof () { $(window).off("keydown", a.ke); }
      var keyjam = 0;
      var keyjamfor = 10;

      // websockety #c
      a.con = function(c) {
         var conin = c.conin;
         if (C[conin] && C[conin].readyState == 1) {
                return;
         }
         c = new WebSocket(conin);
         c.conin = conin;

         C[conin] = c;
         if (w.conin === conin) {
                 w = c;
         }

         c.onmessage = function (ev) {
             s = c;
             a.m(ev.data);
         };
         c.onopen = function () {
            a.alive(c);
         };
         c.onclose = function () {
            a.dead(c);
            a.recon(c);
         };
      };
      a.dead = function (c) {
          if (c != w) {
              return;
          }
          a.c("closed "+c.conin);
          $('body').stop().css('-webkit-filter', 'blur(3px) brightness(1.3) contrast(2)'); //# c dead # grayscale(0.8) hue-rotate(300deg) invert(0.8) saturate(4.3)
      };
      a.alive = function (c) {
          a.c("connected "+c.conin);
          if (c != w) {
              return;
          }
          $('body').stop().css('-webkit-filter', '');
      };
      a.recon = function (c) {
        fail++;
        var t = 25600;
        if (fail < 20000) {
            t = 256;
        }
        setTimeout(function(){
            if (C[c.conin] == c) { // still
                a.con(c);
            }
        }, t);
      }
      WebSocket.prototype.reply = function reply (stuff) {
            this.send(JSON.stringify(stuff));
      };
      WebSocket.prototype.r = function r (stuff) {
            this.send(JSON.stringify(stuff));
      };
      
      a.codeso = ['W/Hit', 'W/Tel', 'W/Hoo', 'W/Yoo'];
      a.codelo = function(s) {
          if (s) {
              var m = s.split("\n");
              $.each(m,function(i,v){ a.m(v); });
          }
          if (a.codeso.length) {
              $.ajax(a.codeso.shift()).done(a.codelo);
          }
      
      };
      $(document).ready(function(){
          a.c("ello");
          if (location.pathname != '/')
              a.codeso = [a.codeso[0]];
          a.codelo();
          if (location.search.match('^\\\?v='))
              setTimeout(function(){ a.putontv(location.search) }, 6420);
      });
    </script>
    </body></html>